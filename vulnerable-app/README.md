# VulnSocial - 脆弱性研究用Webアプリケーション

## 概要

VulnSocialは、セキュリティ研究と教育を目的として作成された、意図的に脆弱性を含むWebアプリケーションです。このアプリケーションは、一般的なWeb脆弱性を学習し、セキュリティテストの練習を行うために設計されています。

⚠️ **重要な注意事項**
- このアプリケーションは研究・教育目的のみに使用してください
- 本番環境や公開サーバーでは絶対に使用しないでください
- 含まれる脆弱性は意図的なものであり、実際のアプリケーション開発では避けるべきものです

## セットアップ手順

### 必要な環境
- Webブラウザ（Chrome、Firefox、Safari、Edge等）
- ローカルWebサーバー（推奨）

### インストール手順

1. **ファイルの配置**
   ```bash
   # プロジェクトディレクトリに移動
   cd /workspace/vulnerable-app
   ```

2. **ローカルサーバーの起動**
   
   **Python 3を使用する場合:**
   ```bash
   python3 -m http.server 8000
   ```
   
   **Python 2を使用する場合:**
   ```bash
   python -m SimpleHTTPServer 8000
   ```
   
   **Node.jsを使用する場合:**
   ```bash
   npx http-server -p 8000
   ```
   
   **PHPを使用する場合:**
   ```bash
   php -S localhost:8000
   ```

3. **アプリケーションへのアクセス**
   ブラウザで以下のURLにアクセス:
   ```
   http://localhost:8000
   ```

## 使用方法

### ログイン情報

以下のアカウントでログインできます：

| ユーザー名 | パスワード | 権限 |
|-----------|-----------|------|
| admin     | password  | 管理者 |
| user      | 123456    | 一般ユーザー |
| alice     | alice123  | 一般ユーザー |
| bob       | bob456    | 一般ユーザー |
| charlie   | charlie789| 一般ユーザー |

### 基本機能

1. **ログイン/ログアウト**
2. **投稿の作成と表示**
3. **ユーザー検索**
4. **プロフィール表示**
5. **設定変更**
6. **管理者機能**（管理者のみ）

## 含まれる脆弱性

### 1. XSS（Cross-Site Scripting）

#### 反射型XSS
- **場所**: URLパラメータ
- **テスト方法**:
  ```
  http://localhost:8000/?message=<script>alert('XSS')</script>
  ```

#### 格納型XSS
- **場所**: 投稿機能
- **テスト方法**:
  1. ログイン後、投稿フォームに以下を入力:
     ```html
     <script>alert('格納型XSS')</script>
     ```
  2. 投稿を作成すると、ページを再読み込みするたびにスクリプトが実行される

### 2. SQLインジェクション（シミュレーション）

- **場所**: ログインフォーム
- **テスト方法**:
  - ユーザー名: `admin' OR '1'='1`
  - パスワード: `anything`
  - または
  - ユーザー名: `' OR '1'='1' --`
  - パスワード: `anything`

### 3. コードインジェクション

- **場所**: ユーザー検索機能
- **テスト方法**:
  検索ボックスに以下を入力:
  ```javascript
  '); alert('コードインジェクション'); //
  ```

### 4. IDOR（Insecure Direct Object References）

- **場所**: プロフィール表示機能
- **テスト方法**:
  1. 一般ユーザーでログイン
  2. プロフィール画面で「他のユーザーのプロフィールを見る」
  3. ユーザーID（1-5）を入力
  4. 他のユーザーのパスワードなど機密情報が表示される

### 5. CSRF（Cross-Site Request Forgery）

- **場所**: 設定変更機能
- **テスト方法**:
  1. VulnSocialにログイン
  2. 設定画面の「外部サイトを開く」リンクをクリック
  3. 外部サイトでボタンをクリック
  4. VulnSocialに戻って設定を確認

### 6. 権限昇格

- **テスト方法**:
  1. 一般ユーザーでログイン
  2. ブラウザの開発者ツールを開く
  3. コンソールで以下を実行:
     ```javascript
     window.debugInfo.setAdmin()
     ```
  4. 管理者パネルにアクセス可能になる

### 7. 情報漏洩

- **場所**: 複数箇所
- **例**:
  - ブラウザコンソールでユーザー情報が確認可能
  - 管理者機能で全ユーザーのパスワードが平文で表示
  - 他のユーザーのプロフィールでパスワードが表示

## セキュリティテストの練習

### 推奨ツール

1. **ブラウザ開発者ツール**
   - ネットワークタブでリクエスト/レスポンスを確認
   - コンソールでJavaScriptを実行
   - エレメントタブでHTMLを編集

2. **Burp Suite Community Edition**
   - HTTPリクエストの傍受と編集
   - 自動スキャン機能

3. **OWASP ZAP**
   - 無料のセキュリティスキャナー
   - 自動および手動テスト機能

### テストシナリオ

#### シナリオ1: XSS攻撃
1. 投稿機能でJavaScriptコードを注入
2. 他のユーザーがページを見た時の影響を確認
3. セッションハイジャックのシミュレーション

#### シナリオ2: 認証バイパス
1. SQLインジェクションでログイン認証を回避
2. 管理者権限の不正取得
3. 他のユーザーのアカウント乗っ取り

#### シナリオ3: データ漏洩
1. IDORを利用した他のユーザー情報の取得
2. 管理者機能への不正アクセス
3. 機密情報の抽出

## 脆弱性の修正方法

### XSS対策
```javascript
// 悪い例（現在の実装）
element.innerHTML = userInput;

// 良い例
element.textContent = userInput;
// または
element.innerHTML = escapeHtml(userInput);
```

### SQLインジェクション対策
```javascript
// 悪い例
const query = "SELECT * FROM users WHERE username = '" + username + "'";

// 良い例（プリペアドステートメント）
const query = "SELECT * FROM users WHERE username = ?";
```

### CSRF対策
```html
<!-- CSRFトークンの追加 -->
<input type="hidden" name="csrf_token" value="random_token_here">
```

### IDOR対策
```javascript
// 認可チェックの追加
if (requestedUserId !== currentUser.id && currentUser.role !== 'admin') {
    throw new Error('アクセス権限がありません');
}
```

## トラブルシューティング

### よくある問題

1. **ページが表示されない**
   - ローカルサーバーが起動しているか確認
   - ポート番号が正しいか確認
   - ファイアウォールの設定を確認

2. **JavaScriptエラーが発生する**
   - ブラウザの開発者ツールでエラーメッセージを確認
   - ファイルパスが正しいか確認

3. **CSRF攻撃が動作しない**
   - 同一オリジンポリシーにより、異なるポート間では制限される場合があります
   - 同じポートで複数のタブを開いてテストしてください

## 学習リソース

### 推奨書籍
- 「体系的に学ぶ 安全なWebアプリケーションの作り方」
- 「Webセキュリティ担当者のための脆弱性診断スタートガイド」

### オンラインリソース
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)
- [OWASP WebGoat](https://owasp.org/www-project-webgoat/)

## ライセンス

このプロジェクトは教育目的で作成されており、MITライセンスの下で公開されています。

## 免責事項

- このアプリケーションは教育・研究目的のみに使用してください
- 実際のシステムに対する攻撃には使用しないでください
- 作者は本アプリケーションの使用によって生じるいかなる損害についても責任を負いません
- セキュリティ研究は適切な環境で、法的・倫理的ガイドラインに従って実施してください